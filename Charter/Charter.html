<!DOCTYPE html>
<html>
<head>
    <title>Charter</title>
</head>
<body>
<article id="top" >
    <h1>Chart it!</h1>
            <p>Select some series to chart...</p>
</article>
<style type="text/css">
li {
  list-style: none;
}

li a {
  text-decoration: none;
  color: #000;
  margin: 10px;
  width: 150px;
  border: 3px dashed #999;
  background: #eee;
  padding: 10px;
  display: block;
}

*[draggable=true] {
  -moz-user-select:none;
  -khtml-user-drag: element;
  cursor: move;
}
</style>

<canvas id="cvs" width="600" height="300">[No canvas support]</canvas>
  <ul>
    <li><a href="#" id="one">Series 1</a></li>
    <li><a href="#" id="two">Series 2</a></li>
    <li><a href="#" id="three">Series 3</a></li>
  </ul>

<script type="text/javascript" src="RGraph.common.core.js"></script>
<script type="text/javascript" src="RGraph.common.adjusting.js"></script>
<script type="text/javascript" src="RGraph.common.annotate.js"></script>
<script type="text/javascript" src="RGraph.common.context.js"></script>
<script type="text/javascript" src="RGraph.common.resizing.js"></script>
<script type="text/javascript" src="RGraph.common.tooltips.js"></script>
<script type="text/javascript" src="RGraph.common.zoom.js"></script>

<script type="text/javascript" src="h5utils.js"></script>

<script type="text/javascript" src="RGraph.line.js"></script>

<script>

        var series1 = [10,4,17,40,25,19,20,25,30,29,30,29];
        var series2 = [12,7,16,23,32,1,3,2,12,11,11,19];
        var series3 = [3,8,12,28,34,13,21,12,19,18,71,15];

        var data = [series1, series2];
        var seriesList = ['Series 1', 'Series 2'];

        var myGraph = new RGraph.Line('cvs', data);
        //myGraph.Set('chart.background.barcolor1', 'rgba(255,255,255,1)');
        //myGraph.Set('chart.background.barcolor2', 'rgba(255,255,255,1)');
        myGraph.Set('chart.background.grid.color', 'rgba(238,238,238,1)');
        myGraph.Set('chart.colors', ['red','blue']);
        myGraph.Set('chart.linewidth', 2);
        myGraph.Set('chart.filled', false);
        myGraph.Set('chart.hmargin', 5);
        myGraph.Set('chart.labels', ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']);
        myGraph.Set('chart.gutter', 40);
        myGraph.Set('chart.zoom.mode', 'thumbnail');
        myGraph.Set('chart.zoom.vdir', 'center');
        myGraph.Set('chart.zoom.thumbnail.width', 100);
        myGraph.Set('chart.zoom.thumbnail.height', 100);
        myGraph.Set('chart.contextmenu', [ ['Zoom  whole graph', RGraph.Zoom] ]);
        myGraph.Set('chart.key',seriesList);

        myGraph.Draw();
            
    RGraph.Register(myGraph);



    myGraph.canvas.onmousemove = function (e)
    {
        RGraph.FixEventObject(e);

        var canvas  = e.target;
        var context = canvas.getContext('2d');
        var obj     = e.target.__object__;

        // This is the new method which simplifies getting coordinates
        var point = obj.getPoint(e);


        if (point) {

            canvas.style.cursor = 'pointer';

            // Is this the same tooltip as the one (if any) that's already being shown
            if (RGraph.Registry.Get('chart.tooltip') && RGraph.Registry.Get('chart.tooltip').__index__ == point[3]) {
                return;
            }

            // Start afresh
            RGraph.Redraw();

            // Show the tooltip
            RGraph.Tooltip(canvas, obj.Get('chart.labels')[point[3]], e.pageX, e.pageY, point[3]);

            // Highlight the point
            context.strokeStyle = 'gray';
            context.fillStyle = 'white';
            context.beginPath();
            context.moveTo(point[1], point[2]);
            context.arc(point[1], point[2], 2, 0, 6.26, 0);
            context.stroke();
            context.fill();

            return;
        }

        canvas.style.cursor = 'default';
    }

    window.onclick = function ()
    {
        RGraph.Redraw();
    }
    
/*  var eat = ['yum!', 'gulp', 'burp!', 'nom'];
  var yum = document.createElement('p');*/
//  var msie = /*@cc_on!@*/0;
//  yum.style.opacity = 1;

  var links = document.querySelectorAll('li > a'), el = null;
  for (var i = 0; i < links.length; i++) {
    el = links[i];

    el.setAttribute('draggable', 'true');

    addEvent(el, 'dragstart', function (e) {
      e.dataTransfer.effectAllowed = 'copy'; // only dropEffect='copy' will be dropable
      e.dataTransfer.setData('Text', this.id); // required otherwise doesn't work
    });
  }

  var cvs = document.querySelector('#cvs');

  addEvent(cvs, 'dragover', function (e) {
    if (e.preventDefault) e.preventDefault(); // allows us to drop
    this.className = 'over';
    e.dataTransfer.dropEffect = 'copy';
    return false;
  });

  // to get IE to work
  addEvent(cvs, 'dragenter', function (e) {
    this.className = 'over';
    return false;
  });

  addEvent(cvs, 'dragleave', function () {
    this.className = '';
  });

  addEvent(cvs, 'drop', function (e) {
    if (e.stopPropagation) e.stopPropagation(); // stops the browser from redirecting...why???

      var text = e.dataTransfer.getData('Text');
    var el = document.getElementById(text);

    el.parentNode.removeChild(el);

    // stupid nom text + fade effect
    if (seriesList.indexOf(text) >= 0)
    {
        seriesList.push(text);
        myGraph.Set('chart.key',seriesList);

        myGraph.Redraw();
    }
    cvs.className = '';
    //yum.innerHTML = eat[parseInt(Math.random() * eat.length)];

    //var y = yum.cloneNode(true);
    //bin.appendChild(y);

    /*setTimeout(function () {
      var t = setInterval(function () {
        if (y.style.opacity <= 0) {
          if (msie) { // don't bother with the animation
            y.style.display = 'none';
          }
          clearInterval(t);
        } else {
          y.style.opacity -= 0.1;
        }
      }, 50);
    }, 250);
*/
    return false;
  });


        /**
    * Makes an AJAX call. It calls the given callback (a function) when ready
    *
    * @param string   url      The URL to retrieve
    * @param function callback A function object that is called when the response is ready, there's an example below
    *                          called "myCallback".
    */
    function AjaxCall (url, callback)
    {
        // Mozilla, Safari, ...
        if (window.XMLHttpRequest) {
            var httpRequest = new XMLHttpRequest();

        // MSIE
        } else if (window.ActiveXObject) {
            var httpRequest = new ActiveXObject("Microsoft.XMLHTTP");
        }

        httpRequest.onreadystatechange = callback;

        httpRequest.open('GET', url, true);
        httpRequest.send();
    }


    /**
    * This sample callback function is called when the data is ready (readyState=4)
    */
    function myCallback ()
    {
        if (this.readyState == 4 && this.status == 200) {
            // Everything is good, the response is received
            alert(this.responseText);
        }
    }
  </script>
</body>
</html>